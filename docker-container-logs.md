2025-11-19 21:50:16.764 | [18:50:16 INF] Starting SurveyBot API application {"Application": "SurveyBot.API"}
2025-11-19 21:50:17.011 | [18:50:17 INF] Applying database migrations... {"Application": "SurveyBot.API"}
2025-11-19 21:50:17.044 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:50:17.046 | [18:50:17 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"Application": "SurveyBot.API"}
2025-11-19 21:50:18.037 | [18:50:18 WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development. {"EventId": {"Id": 10400, "Name": "Microsoft.EntityFrameworkCore.Infrastructure.SensitiveDataLoggingEnabledWarning"}, "SourceContext": "Microsoft.EntityFrameworkCore.Model.Validation", "Application": "SurveyBot.API"}
2025-11-19 21:50:18.595 | [18:50:18 INF] Executed DbCommand (24ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
2025-11-19 21:50:18.595 | SELECT "MigrationId", "ProductVersion"
2025-11-19 21:50:18.595 | FROM "__EFMigrationsHistory"
2025-11-19 21:50:18.595 | ORDER BY "MigrationId"; {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "Application": "SurveyBot.API"}
2025-11-19 21:50:18.668 | [18:50:18 INF] Database is up to date. No pending migrations {"Application": "SurveyBot.API"}
2025-11-19 21:50:18.676 | [18:50:18 INF] Starting Telegram Bot initialization... {"SourceContext": "SurveyBot.Bot.Interfaces.IBotService", "Application": "SurveyBot.API"}
2025-11-19 21:50:18.686 | [18:50:18 INF] BotService created successfully {"SourceContext": "SurveyBot.Bot.Services.BotService", "Application": "SurveyBot.API"}
2025-11-19 21:50:18.689 | [18:50:18 INF] Initializing bot... {"SourceContext": "SurveyBot.Bot.Services.BotService", "Application": "SurveyBot.API"}
2025-11-19 21:50:19.633 | [18:50:19 INF] Bot initialized successfully. Bot: @SecondTestSurveyBot (ID: 8540672675) {"SourceContext": "SurveyBot.Bot.Services.BotService", "Application": "SurveyBot.API"}
2025-11-19 21:50:19.634 | [18:50:19 INF] Bot initialized: @SecondTestSurveyBot (ID: 8540672675) {"SourceContext": "SurveyBot.Bot.Interfaces.IBotService", "Application": "SurveyBot.API"}
2025-11-19 21:50:19.635 | [18:50:19 INF] Webhook mode enabled, setting up webhook... {"SourceContext": "SurveyBot.Bot.Interfaces.IBotService", "Application": "SurveyBot.API"}
2025-11-19 21:50:19.637 | [18:50:19 INF] Setting webhook to: https://3c6dfc99c860.ngrok-free.app/api/bot/webhook {"SourceContext": "SurveyBot.Bot.Services.BotService", "Application": "SurveyBot.API"}
2025-11-19 21:50:19.801 | [18:50:19 INF] Webhook set successfully {"SourceContext": "SurveyBot.Bot.Services.BotService", "Application": "SurveyBot.API"}
2025-11-19 21:50:19.939 | [18:50:19 INF] Webhook info: URL=https://3c6dfc99c860.ngrok-free.app/api/bot/webhook, PendingUpdateCount=0, LastError=None {"SourceContext": "SurveyBot.Bot.Services.BotService", "Application": "SurveyBot.API"}
2025-11-19 21:50:19.940 | [18:50:19 INF] Webhook configured successfully {"SourceContext": "SurveyBot.Bot.Interfaces.IBotService", "Application": "SurveyBot.API"}
2025-11-19 21:50:19.941 | [18:50:19 INF] Telegram Bot initialization completed successfully {"SourceContext": "SurveyBot.Bot.Interfaces.IBotService", "Application": "SurveyBot.API"}
2025-11-19 21:50:19.942 | [18:50:19 INF] Telegram Bot initialized successfully {"Application": "SurveyBot.API"}
2025-11-19 21:50:19.945 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:50:19.945 | [18:50:19 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"Application": "SurveyBot.API"}
2025-11-19 21:50:19.979 | 
2025-11-19 21:50:19.979 | === Dependency Injection Verification ===
2025-11-19 21:50:19.979 | âœ“ All services resolved successfully!
2025-11-19 21:50:19.979 | 
2025-11-19 21:50:19.979 | Registered Services:
2025-11-19 21:50:19.979 |   - SurveyBotDbContext (Scoped)
2025-11-19 21:50:19.979 |   - ISurveyRepository -> SurveyRepository (Scoped)
2025-11-19 21:50:19.979 |   - IQuestionRepository -> QuestionRepository (Scoped)
2025-11-19 21:50:19.979 |   - IResponseRepository -> ResponseRepository (Scoped)
2025-11-19 21:50:19.979 |   - IUserRepository -> UserRepository (Scoped)
2025-11-19 21:50:19.979 |   - IAnswerRepository -> AnswerRepository (Scoped)
2025-11-19 21:50:19.979 | ==========================================
2025-11-19 21:50:19.979 | 
2025-11-19 21:50:20.084 | [18:50:20 INF] SurveyBot API started successfully {"Application": "SurveyBot.API"}
2025-11-19 21:50:20.099 | [18:50:20 WRN] Storing keys in a directory '/root/.aspnet/DataProtection-Keys' that may not be persisted outside of the container. Protected data will be unavailable when container is destroyed. For more information go to https://aka.ms/aspnet/dataprotectionwarning {"EventId": {"Id": 60, "Name": "UsingEphemeralFileSystemLocationInContainer"}, "SourceContext": "Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository", "Application": "SurveyBot.API"}
2025-11-19 21:50:20.104 | [18:50:20 INF] BackgroundTaskQueue initialized with capacity 100 {"SourceContext": "SurveyBot.API.Services.BackgroundTaskQueue", "Application": "SurveyBot.API"}
2025-11-19 21:50:20.126 | [18:50:20 WRN] No XML encryptor configured. Key {66f8ed3e-c5b9-4046-9721-e04d0d1aed0b} may be persisted to storage in unencrypted form. {"EventId": {"Id": 35, "Name": "NoXMLEncryptorConfiguredKeyMayBePersistedToStorageInUnencryptedForm"}, "SourceContext": "Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager", "Application": "SurveyBot.API"}
2025-11-19 21:50:20.139 | [18:50:20 INF] QueuedHostedService is starting {"SourceContext": "SurveyBot.API.Services.QueuedHostedService", "Application": "SurveyBot.API"}
2025-11-19 21:50:20.146 | [18:50:20 WRN] Overriding HTTP_PORTS '8080' and HTTPS_PORTS ''. Binding to values defined by URLS instead 'http://+:8080'. {"EventId": {"Id": 15}, "SourceContext": "Microsoft.AspNetCore.Hosting.Diagnostics", "Application": "SurveyBot.API"}
2025-11-19 21:50:20.199 | [18:50:20 WRN] The WebRootPath was not found: /app/wwwroot. Static files may be unavailable. {"EventId": {"Id": 16, "Name": "WebRootPathNotFound"}, "SourceContext": "Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware", "Application": "SurveyBot.API"}
2025-11-19 21:50:20.237 | [18:50:20 INF] Now listening on: http://[::]:8080 {"EventId": {"Id": 14, "Name": "ListeningOnAddress"}, "SourceContext": "Microsoft.Hosting.Lifetime", "Application": "SurveyBot.API"}
2025-11-19 21:50:20.238 | [18:50:20 INF] Application started. Press Ctrl+C to shut down. {"SourceContext": "Microsoft.Hosting.Lifetime", "Application": "SurveyBot.API"}
2025-11-19 21:50:20.238 | [18:50:20 INF] Hosting environment: Development {"SourceContext": "Microsoft.Hosting.Lifetime", "Application": "SurveyBot.API"}
2025-11-19 21:50:20.239 | [18:50:20 INF] Content root path: /app {"SourceContext": "Microsoft.Hosting.Lifetime", "Application": "SurveyBot.API"}
2025-11-19 21:50:21.466 | [18:50:21 INF] HTTP GET /health/db started. TraceId: 0HNH7JHUUK3MR:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MR:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3MR", "Application": "SurveyBot.API"}
2025-11-19 21:50:21.499 | [18:50:21 WRN] Failed to determine the https port for redirect. {"EventId": {"Id": 3, "Name": "FailedToDeterminePort"}, "SourceContext": "Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware", "RequestId": "0HNH7JHUUK3MR:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3MR", "Application": "SurveyBot.API"}
2025-11-19 21:50:21.529 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:50:21.529 | [18:50:21 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"RequestId": "0HNH7JHUUK3MR:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3MR", "Application": "SurveyBot.API"}
2025-11-19 21:50:21.644 | [18:50:21 INF] HTTP GET /health/db responded 200 in 182ms. TraceId: 0HNH7JHUUK3MR:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MR:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3MR", "Application": "SurveyBot.API"}
2025-11-19 21:50:21.663 | [18:50:21 INF] HTTP GET /health/db responded 200 in 185.9021 ms {"RequestHost": "localhost:8080", "RequestScheme": "http", "RemoteIP": "::ffff:127.0.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MR:00000001", "ConnectionId": "0HNH7JHUUK3MR", "Application": "SurveyBot.API"}
2025-11-19 21:50:51.801 | [18:50:51 INF] HTTP GET /health/db started. TraceId: 0HNH7JHUUK3MS:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MS:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3MS", "Application": "SurveyBot.API"}
2025-11-19 21:50:51.808 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:50:51.808 | [18:50:51 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"RequestId": "0HNH7JHUUK3MS:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3MS", "Application": "SurveyBot.API"}
2025-11-19 21:50:51.840 | [18:50:51 INF] HTTP GET /health/db responded 200 in 38ms. TraceId: 0HNH7JHUUK3MS:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MS:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3MS", "Application": "SurveyBot.API"}
2025-11-19 21:50:51.842 | [18:50:51 INF] HTTP GET /health/db responded 200 in 39.9348 ms {"RequestHost": "localhost:8080", "RequestScheme": "http", "RemoteIP": "::ffff:127.0.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MS:00000001", "ConnectionId": "0HNH7JHUUK3MS", "Application": "SurveyBot.API"}
2025-11-19 21:51:19.440 | [18:51:19 INF] HTTP OPTIONS /api/surveys started. TraceId: 0HNH7JHUUK3MU:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MU:00000001", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:19.440 | [18:51:19 INF] HTTP OPTIONS /api/surveys started. TraceId: 0HNH7JHUUK3MT:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000001", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:19.450 | [18:51:19 INF] HTTP OPTIONS /api/surveys responded 204 in 10ms. TraceId: 0HNH7JHUUK3MT:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000001", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:19.450 | [18:51:19 INF] HTTP OPTIONS /api/surveys responded 204 in 10ms. TraceId: 0HNH7JHUUK3MU:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MU:00000001", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:19.450 | [18:51:19 INF] HTTP OPTIONS /api/surveys responded 204 in 10.8846 ms {"RequestHost": "localhost:5000", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000001", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:19.452 | [18:51:19 INF] HTTP OPTIONS /api/surveys responded 204 in 11.9150 ms {"RequestHost": "localhost:5000", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MU:00000001", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:19.463 | [18:51:19 INF] HTTP GET /api/surveys started. TraceId: 0HNH7JHUUK3MU:00000002 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:19.518 | [18:51:19 DBG] JWT token validated for user ID: 4 {"RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:19.546 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:51:19.546 | [18:51:19 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:19.748 | [18:51:19 INF] Getting surveys for user 4 {"SourceContext": "SurveyBot.API.Controllers.SurveysController", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:19.751 | [18:51:19 INF] Getting surveys for user 4 with pagination {"SourceContext": "SurveyBot.Infrastructure.Services.SurveyService", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.281 | [18:51:20 WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'. {"EventId": {"Id": 20504, "Name": "Microsoft.EntityFrameworkCore.Query.MultipleCollectionIncludeWarning"}, "SourceContext": "Microsoft.EntityFrameworkCore.Query", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.395 | [18:51:20 INF] Executed DbCommand (29ms) [Parameters=[@__creatorId_0='4'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.395 | SELECT s.id, s.allow_multiple_responses, s.code, s.created_at, s.creator_id, s.description, s.is_active, s.show_results, s.title, s.updated_at, q.id, q.created_at, q.is_required, q.media_content, q.options_json, q.order_index, q.question_text, q.question_type, q.survey_id, q.updated_at, r.id, r.is_complete, r.respondent_telegram_id, r.started_at, r.submitted_at, r.survey_id
2025-11-19 21:51:20.395 | FROM surveys AS s
2025-11-19 21:51:20.395 | LEFT JOIN questions AS q ON s.id = q.survey_id
2025-11-19 21:51:20.395 | LEFT JOIN responses AS r ON s.id = r.survey_id
2025-11-19 21:51:20.395 | WHERE s.creator_id = @__creatorId_0
2025-11-19 21:51:20.395 | ORDER BY s.created_at DESC, s.id, q.id {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.643 | [18:51:20 INF] Executed DbCommand (3ms) [Parameters=[@__surveyId_0='14'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.643 | SELECT count(*)::int
2025-11-19 21:51:20.643 | FROM responses AS r
2025-11-19 21:51:20.643 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.661 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='14'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.661 | SELECT count(*)::int
2025-11-19 21:51:20.661 | FROM responses AS r
2025-11-19 21:51:20.661 | WHERE r.survey_id = @__surveyId_0 AND r.is_complete {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.667 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='15'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.667 | SELECT count(*)::int
2025-11-19 21:51:20.667 | FROM responses AS r
2025-11-19 21:51:20.667 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.669 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='15'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.669 | SELECT count(*)::int
2025-11-19 21:51:20.669 | FROM responses AS r
2025-11-19 21:51:20.669 | WHERE r.survey_id = @__surveyId_0 AND r.is_complete {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.671 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='16'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.671 | SELECT count(*)::int
2025-11-19 21:51:20.671 | FROM responses AS r
2025-11-19 21:51:20.671 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.674 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='16'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.674 | SELECT count(*)::int
2025-11-19 21:51:20.674 | FROM responses AS r
2025-11-19 21:51:20.674 | WHERE r.survey_id = @__surveyId_0 AND r.is_complete {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.676 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='17'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.676 | SELECT count(*)::int
2025-11-19 21:51:20.676 | FROM responses AS r
2025-11-19 21:51:20.676 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.678 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='17'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.679 | SELECT count(*)::int
2025-11-19 21:51:20.679 | FROM responses AS r
2025-11-19 21:51:20.679 | WHERE r.survey_id = @__surveyId_0 AND r.is_complete {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.682 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='18'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.682 | SELECT count(*)::int
2025-11-19 21:51:20.682 | FROM responses AS r
2025-11-19 21:51:20.682 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.684 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='18'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.684 | SELECT count(*)::int
2025-11-19 21:51:20.684 | FROM responses AS r
2025-11-19 21:51:20.684 | WHERE r.survey_id = @__surveyId_0 AND r.is_complete {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.716 | [18:51:20 INF] HTTP GET /api/surveys responded 200 in 1252ms. TraceId: 0HNH7JHUUK3MU:00000002 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MU:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.716 | [18:51:20 INF] HTTP GET /api/surveys started. TraceId: 0HNH7JHUUK3MT:00000002 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.716 | [18:51:20 INF] HTTP GET /api/surveys responded 200 in 1253.0593 ms {"RequestHost": "localhost:5000", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MU:00000002", "ConnectionId": "0HNH7JHUUK3MU", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.718 | [18:51:20 DBG] JWT token validated for user ID: 4 {"RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.723 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:51:20.723 | [18:51:20 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.728 | [18:51:20 INF] Getting surveys for user 4 {"SourceContext": "SurveyBot.API.Controllers.SurveysController", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.729 | [18:51:20 INF] Getting surveys for user 4 with pagination {"SourceContext": "SurveyBot.Infrastructure.Services.SurveyService", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.736 | [18:51:20 INF] Executed DbCommand (4ms) [Parameters=[@__creatorId_0='4'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.736 | SELECT s.id, s.allow_multiple_responses, s.code, s.created_at, s.creator_id, s.description, s.is_active, s.show_results, s.title, s.updated_at, q.id, q.created_at, q.is_required, q.media_content, q.options_json, q.order_index, q.question_text, q.question_type, q.survey_id, q.updated_at, r.id, r.is_complete, r.respondent_telegram_id, r.started_at, r.submitted_at, r.survey_id
2025-11-19 21:51:20.736 | FROM surveys AS s
2025-11-19 21:51:20.736 | LEFT JOIN questions AS q ON s.id = q.survey_id
2025-11-19 21:51:20.736 | LEFT JOIN responses AS r ON s.id = r.survey_id
2025-11-19 21:51:20.736 | WHERE s.creator_id = @__creatorId_0
2025-11-19 21:51:20.736 | ORDER BY s.created_at DESC, s.id, q.id {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.748 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='14'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.748 | SELECT count(*)::int
2025-11-19 21:51:20.748 | FROM responses AS r
2025-11-19 21:51:20.748 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.751 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='14'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.751 | SELECT count(*)::int
2025-11-19 21:51:20.751 | FROM responses AS r
2025-11-19 21:51:20.751 | WHERE r.survey_id = @__surveyId_0 AND r.is_complete {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.755 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='15'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.755 | SELECT count(*)::int
2025-11-19 21:51:20.755 | FROM responses AS r
2025-11-19 21:51:20.755 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.759 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='15'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.759 | SELECT count(*)::int
2025-11-19 21:51:20.759 | FROM responses AS r
2025-11-19 21:51:20.759 | WHERE r.survey_id = @__surveyId_0 AND r.is_complete {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.764 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='16'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.764 | SELECT count(*)::int
2025-11-19 21:51:20.764 | FROM responses AS r
2025-11-19 21:51:20.764 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.770 | [18:51:20 INF] Executed DbCommand (2ms) [Parameters=[@__surveyId_0='16'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.770 | SELECT count(*)::int
2025-11-19 21:51:20.770 | FROM responses AS r
2025-11-19 21:51:20.770 | WHERE r.survey_id = @__surveyId_0 AND r.is_complete {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.773 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='17'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.773 | SELECT count(*)::int
2025-11-19 21:51:20.773 | FROM responses AS r
2025-11-19 21:51:20.773 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.776 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='17'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.776 | SELECT count(*)::int
2025-11-19 21:51:20.776 | FROM responses AS r
2025-11-19 21:51:20.776 | WHERE r.survey_id = @__surveyId_0 AND r.is_complete {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.778 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='18'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.778 | SELECT count(*)::int
2025-11-19 21:51:20.778 | FROM responses AS r
2025-11-19 21:51:20.778 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.780 | [18:51:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='18'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:51:20.780 | SELECT count(*)::int
2025-11-19 21:51:20.780 | FROM responses AS r
2025-11-19 21:51:20.780 | WHERE r.survey_id = @__surveyId_0 AND r.is_complete {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "bbc537de-a41c-457e-a7b3-006306bcd293", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveys (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.781 | [18:51:20 INF] HTTP GET /api/surveys responded 200 in 65ms. TraceId: 0HNH7JHUUK3MT:00000002 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000002", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:20.782 | [18:51:20 INF] HTTP GET /api/surveys responded 200 in 65.8306 ms {"RequestHost": "localhost:5000", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000002", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:21.970 | [18:51:21 INF] HTTP GET /health/db started. TraceId: 0HNH7JHUUK3MV:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MV:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3MV", "Application": "SurveyBot.API"}
2025-11-19 21:51:21.971 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:51:21.971 | [18:51:21 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"RequestId": "0HNH7JHUUK3MV:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3MV", "Application": "SurveyBot.API"}
2025-11-19 21:51:21.987 | [18:51:21 INF] HTTP GET /health/db responded 200 in 17ms. TraceId: 0HNH7JHUUK3MV:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MV:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3MV", "Application": "SurveyBot.API"}
2025-11-19 21:51:21.988 | [18:51:21 INF] HTTP GET /health/db responded 200 in 18.3881 ms {"RequestHost": "localhost:8080", "RequestScheme": "http", "RemoteIP": "::ffff:127.0.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MV:00000001", "ConnectionId": "0HNH7JHUUK3MV", "Application": "SurveyBot.API"}
2025-11-19 21:51:52.113 | [18:51:52 INF] HTTP GET /health/db started. TraceId: 0HNH7JHUUK3N0:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N0:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3N0", "Application": "SurveyBot.API"}
2025-11-19 21:51:52.115 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:51:52.115 | [18:51:52 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"RequestId": "0HNH7JHUUK3N0:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3N0", "Application": "SurveyBot.API"}
2025-11-19 21:51:52.133 | [18:51:52 INF] HTTP GET /health/db responded 200 in 19ms. TraceId: 0HNH7JHUUK3N0:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N0:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3N0", "Application": "SurveyBot.API"}
2025-11-19 21:51:52.133 | [18:51:52 INF] HTTP GET /health/db responded 200 in 20.0654 ms {"RequestHost": "localhost:8080", "RequestScheme": "http", "RemoteIP": "::ffff:127.0.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N0:00000001", "ConnectionId": "0HNH7JHUUK3N0", "Application": "SurveyBot.API"}
2025-11-19 21:51:57.961 | [18:51:57 INF] HTTP OPTIONS /api/media/upload started. TraceId: 0HNH7JHUUK3MT:00000003 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000003", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:57.963 | [18:51:57 INF] HTTP OPTIONS /api/media/upload responded 204 in 1ms. TraceId: 0HNH7JHUUK3MT:00000003 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000003", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:57.964 | [18:51:57 INF] HTTP OPTIONS /api/media/upload responded 204 in 2.1252 ms {"RequestHost": "localhost:5000", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000003", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:57.977 | [18:51:57 INF] HTTP POST /api/media/upload started. TraceId: 0HNH7JHUUK3MT:00000004 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:57.978 | [18:51:57 DBG] JWT token validated for user ID: 4 {"RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:57.991 | [18:51:57 WRN] WebRootPath was null. Using fallback: /app/wwwroot {"SourceContext": "SurveyBot.Infrastructure.Services.FileSystemMediaStorageService", "ActionId": "1c219ade-5f50-4992-9552-ae5308ab8c0c", "ActionName": "SurveyBot.API.Controllers.MediaController.UploadMedia (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:57.992 | [18:51:57 INF] Created media storage directory: /app/wwwroot {"SourceContext": "SurveyBot.Infrastructure.Services.FileSystemMediaStorageService", "ActionId": "1c219ade-5f50-4992-9552-ae5308ab8c0c", "ActionName": "SurveyBot.API.Controllers.MediaController.UploadMedia (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:57.994 | [18:51:57 INF] Created media uploads directory: /app/wwwroot/uploads/media {"SourceContext": "SurveyBot.Infrastructure.Services.FileSystemMediaStorageService", "ActionId": "1c219ade-5f50-4992-9552-ae5308ab8c0c", "ActionName": "SurveyBot.API.Controllers.MediaController.UploadMedia (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:57.995 | [18:51:57 INF] Media storage initialized successfully at: /app/wwwroot {"SourceContext": "SurveyBot.Infrastructure.Services.FileSystemMediaStorageService", "ActionId": "1c219ade-5f50-4992-9552-ae5308ab8c0c", "ActionName": "SurveyBot.API.Controllers.MediaController.UploadMedia (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:58.046 | [18:51:58 INF] Starting media upload. MediaType: image, FileName: stopa_3.jpg {"SourceContext": "SurveyBot.API.Controllers.MediaController", "ActionId": "1c219ade-5f50-4992-9552-ae5308ab8c0c", "ActionName": "SurveyBot.API.Controllers.MediaController.UploadMedia (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:58.047 | [18:51:58 DBG] Validating file: stopa_3.jpg, Size: 20482 bytes, Type: image {"SourceContext": "SurveyBot.API.Controllers.MediaController", "ActionId": "1c219ade-5f50-4992-9552-ae5308ab8c0c", "ActionName": "SurveyBot.API.Controllers.MediaController.UploadMedia (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:58.055 | [18:51:58 DBG] Media validation passed for stopa_3.jpg {"SourceContext": "SurveyBot.Infrastructure.Services.MediaValidationService", "ActionId": "1c219ade-5f50-4992-9552-ae5308ab8c0c", "ActionName": "SurveyBot.API.Controllers.MediaController.UploadMedia (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:58.055 | [18:51:58 DBG] Saving media file: stopa_3.jpg {"SourceContext": "SurveyBot.API.Controllers.MediaController", "ActionId": "1c219ade-5f50-4992-9552-ae5308ab8c0c", "ActionName": "SurveyBot.API.Controllers.MediaController.UploadMedia (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:58.058 | [18:51:58 DBG] Media validation passed for stopa_3.jpg {"SourceContext": "SurveyBot.Infrastructure.Services.MediaValidationService", "ActionId": "1c219ade-5f50-4992-9552-ae5308ab8c0c", "ActionName": "SurveyBot.API.Controllers.MediaController.UploadMedia (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:58.059 | [18:51:58 DBG] Created storage directory: /app/wwwroot/uploads/media/2025/11 {"SourceContext": "SurveyBot.Infrastructure.Services.FileSystemMediaStorageService", "ActionId": "1c219ade-5f50-4992-9552-ae5308ab8c0c", "ActionName": "SurveyBot.API.Controllers.MediaController.UploadMedia (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:58.062 | [18:51:58 INF] Media file saved successfully: /app/wwwroot/uploads/media/2025/11/99ec900b-9bc6-4b09-94fa-11b733493e95.jpg (20482 bytes) {"SourceContext": "SurveyBot.Infrastructure.Services.FileSystemMediaStorageService", "ActionId": "1c219ade-5f50-4992-9552-ae5308ab8c0c", "ActionName": "SurveyBot.API.Controllers.MediaController.UploadMedia (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:58.332 | [18:51:58 INF] Thumbnail generated: /app/wwwroot/uploads/media/2025/11/99ec900b-9bc6-4b09-94fa-11b733493e95_thumb.jpg (Original: /app/wwwroot/uploads/media/2025/11/99ec900b-9bc6-4b09-94fa-11b733493e95.jpg) {"SourceContext": "SurveyBot.Infrastructure.Services.FileSystemMediaStorageService", "ActionId": "1c219ade-5f50-4992-9552-ae5308ab8c0c", "ActionName": "SurveyBot.API.Controllers.MediaController.UploadMedia (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:58.335 | [18:51:58 INF] Media item created: ID=fcf11f4b-3995-4d7b-a7b7-7fde18c0d018, Type=image, Size=20482 bytes, Thumbnail=True {"SourceContext": "SurveyBot.Infrastructure.Services.FileSystemMediaStorageService", "ActionId": "1c219ade-5f50-4992-9552-ae5308ab8c0c", "ActionName": "SurveyBot.API.Controllers.MediaController.UploadMedia (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:58.337 | [18:51:58 INF] Media upload successful. ID: fcf11f4b-3995-4d7b-a7b7-7fde18c0d018, Type: image, Size: 20482 bytes, Path: /uploads/media/2025/11/99ec900b-9bc6-4b09-94fa-11b733493e95.jpg {"SourceContext": "SurveyBot.API.Controllers.MediaController", "ActionId": "1c219ade-5f50-4992-9552-ae5308ab8c0c", "ActionName": "SurveyBot.API.Controllers.MediaController.UploadMedia (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:58.373 | [18:51:58 INF] HTTP POST /api/media/upload responded 201 in 395ms. TraceId: 0HNH7JHUUK3MT:00000004 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000004", "RequestPath": "/api/media/upload", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:51:58.373 | [18:51:58 INF] HTTP POST /api/media/upload responded 201 in 396.0543 ms {"RequestHost": "localhost:5000", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000004", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.423 | [18:52:20 INF] HTTP OPTIONS /api/surveys started. TraceId: 0HNH7JHUUK3MT:00000005 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000005", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.426 | [18:52:20 INF] HTTP OPTIONS /api/surveys responded 204 in 3ms. TraceId: 0HNH7JHUUK3MT:00000005 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000005", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.431 | [18:52:20 INF] HTTP OPTIONS /api/surveys responded 204 in 7.4826 ms {"RequestHost": "localhost:5000", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000005", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.437 | [18:52:20 INF] HTTP POST /api/surveys started. TraceId: 0HNH7JHUUK3MT:00000006 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000006", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.442 | [18:52:20 DBG] JWT token validated for user ID: 4 {"RequestId": "0HNH7JHUUK3MT:00000006", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.453 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:52:20.454 | [18:52:20 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"ActionId": "2752673a-7b97-4b2a-abf0-6e72604ba312", "ActionName": "SurveyBot.API.Controllers.SurveysController.CreateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000006", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.466 | [18:52:20 INF] Creating survey for user 4 {"SourceContext": "SurveyBot.API.Controllers.SurveysController", "ActionId": "2752673a-7b97-4b2a-abf0-6e72604ba312", "ActionName": "SurveyBot.API.Controllers.SurveysController.CreateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000006", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.468 | [18:52:20 INF] Creating new survey for user 4: testing9 {"SourceContext": "SurveyBot.Infrastructure.Services.SurveyService", "ActionId": "2752673a-7b97-4b2a-abf0-6e72604ba312", "ActionName": "SurveyBot.API.Controllers.SurveysController.CreateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000006", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.500 | [18:52:20 INF] Executed DbCommand (3ms) [Parameters=[@__ToUpper_0='ORN90O'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:20.500 | SELECT EXISTS (
2025-11-19 21:52:20.500 |     SELECT 1
2025-11-19 21:52:20.500 |     FROM surveys AS s
2025-11-19 21:52:20.500 |     WHERE s.code = @__ToUpper_0) {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "2752673a-7b97-4b2a-abf0-6e72604ba312", "ActionName": "SurveyBot.API.Controllers.SurveysController.CreateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000006", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.504 | [18:52:20 INF] Generated unique code ORN90O for survey {"SourceContext": "SurveyBot.Infrastructure.Services.SurveyService", "ActionId": "2752673a-7b97-4b2a-abf0-6e72604ba312", "ActionName": "SurveyBot.API.Controllers.SurveysController.CreateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000006", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.662 | [18:52:20 INF] Executed DbCommand (16ms) [Parameters=[@p0='ORN90O', @p1='2025-11-19T18:52:20.5635129Z' (DbType = DateTime), @p2='4', @p3='twsting', @p4='False', @p5='testing9' (Nullable = false), @p6='2025-11-19T18:52:20.5635566Z' (DbType = DateTime)], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:20.662 | INSERT INTO surveys (code, created_at, creator_id, description, is_active, title, updated_at)
2025-11-19 21:52:20.662 | VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6)
2025-11-19 21:52:20.662 | RETURNING id, allow_multiple_responses, show_results; {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "2752673a-7b97-4b2a-abf0-6e72604ba312", "ActionName": "SurveyBot.API.Controllers.SurveysController.CreateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000006", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.693 | [18:52:20 INF] Survey 19 created successfully by user 4 with code ORN90O {"SourceContext": "SurveyBot.Infrastructure.Services.SurveyService", "ActionId": "2752673a-7b97-4b2a-abf0-6e72604ba312", "ActionName": "SurveyBot.API.Controllers.SurveysController.CreateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000006", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.740 | [18:52:20 INF] HTTP POST /api/surveys responded 201 in 302ms. TraceId: 0HNH7JHUUK3MT:00000006 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000006", "RequestPath": "/api/surveys", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.741 | [18:52:20 INF] HTTP POST /api/surveys responded 201 in 303.8070 ms {"RequestHost": "localhost:5000", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000006", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.746 | [18:52:20 INF] HTTP OPTIONS /api/surveys/19/questions started. TraceId: 0HNH7JHUUK3MT:00000007 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000007", "RequestPath": "/api/surveys/19/questions", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.746 | [18:52:20 INF] HTTP OPTIONS /api/surveys/19/questions responded 204 in 0ms. TraceId: 0HNH7JHUUK3MT:00000007 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000007", "RequestPath": "/api/surveys/19/questions", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.747 | [18:52:20 INF] HTTP OPTIONS /api/surveys/19/questions responded 204 in 1.6986 ms {"RequestHost": "localhost:5000", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000007", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.755 | [18:52:20 INF] HTTP POST /api/surveys/19/questions started. TraceId: 0HNH7JHUUK3MT:00000008 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000008", "RequestPath": "/api/surveys/19/questions", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.756 | [18:52:20 DBG] JWT token validated for user ID: 4 {"RequestId": "0HNH7JHUUK3MT:00000008", "RequestPath": "/api/surveys/19/questions", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.765 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:52:20.765 | [18:52:20 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"ActionId": "18eaf8f1-8ff3-4032-bbbf-764efab79004", "ActionName": "SurveyBot.API.Controllers.QuestionsController.CreateQuestion (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000008", "RequestPath": "/api/surveys/19/questions", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.817 | [18:52:20 INF] Creating question for survey 19 by user 4 {"SourceContext": "SurveyBot.API.Controllers.QuestionsController", "ActionId": "18eaf8f1-8ff3-4032-bbbf-764efab79004", "ActionName": "SurveyBot.API.Controllers.QuestionsController.CreateQuestion (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000008", "RequestPath": "/api/surveys/19/questions", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.820 | [18:52:20 INF] Adding question to survey 19 by user 4 {"SourceContext": "SurveyBot.Infrastructure.Services.QuestionService", "ActionId": "18eaf8f1-8ff3-4032-bbbf-764efab79004", "ActionName": "SurveyBot.API.Controllers.QuestionsController.CreateQuestion (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000008", "RequestPath": "/api/surveys/19/questions", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.916 | [18:52:20 INF] Executed DbCommand (4ms) [Parameters=[@__id_0='19'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:20.916 | SELECT s0.id, s0.allow_multiple_responses, s0.code, s0.created_at, s0.creator_id, s0.description, s0.is_active, s0.show_results, s0.title, s0.updated_at, s0.id0, q.id, q.created_at, q.is_required, q.media_content, q.options_json, q.order_index, q.question_text, q.question_type, q.survey_id, q.updated_at, s0.created_at0, s0.first_name, s0.last_login_at, s0.last_name, s0.telegram_id, s0.updated_at0, s0.username
2025-11-19 21:52:20.916 | FROM (
2025-11-19 21:52:20.916 |     SELECT s.id, s.allow_multiple_responses, s.code, s.created_at, s.creator_id, s.description, s.is_active, s.show_results, s.title, s.updated_at, u.id AS id0, u.created_at AS created_at0, u.first_name, u.last_login_at, u.last_name, u.telegram_id, u.updated_at AS updated_at0, u.username
2025-11-19 21:52:20.916 |     FROM surveys AS s
2025-11-19 21:52:20.916 |     INNER JOIN users AS u ON s.creator_id = u.id
2025-11-19 21:52:20.916 |     WHERE s.id = @__id_0
2025-11-19 21:52:20.916 |     LIMIT 1
2025-11-19 21:52:20.916 | ) AS s0
2025-11-19 21:52:20.916 | LEFT JOIN questions AS q ON s0.id = q.survey_id
2025-11-19 21:52:20.916 | ORDER BY s0.id, s0.id0, q.order_index {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "18eaf8f1-8ff3-4032-bbbf-764efab79004", "ActionName": "SurveyBot.API.Controllers.QuestionsController.CreateQuestion (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000008", "RequestPath": "/api/surveys/19/questions", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.930 | [18:52:20 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='19'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:20.930 | SELECT EXISTS (
2025-11-19 21:52:20.930 |     SELECT 1
2025-11-19 21:52:20.930 |     FROM responses AS r
2025-11-19 21:52:20.930 |     WHERE r.survey_id = @__surveyId_0) {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "18eaf8f1-8ff3-4032-bbbf-764efab79004", "ActionName": "SurveyBot.API.Controllers.QuestionsController.CreateQuestion (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000008", "RequestPath": "/api/surveys/19/questions", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:20.955 | [18:52:20 INF] Executed DbCommand (2ms) [Parameters=[@__surveyId_0='19'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:20.955 | SELECT max(q.order_index)
2025-11-19 21:52:20.955 | FROM questions AS q
2025-11-19 21:52:20.955 | WHERE q.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "18eaf8f1-8ff3-4032-bbbf-764efab79004", "ActionName": "SurveyBot.API.Controllers.QuestionsController.CreateQuestion (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000008", "RequestPath": "/api/surveys/19/questions", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.003 | [18:52:21 INF] Executed DbCommand (12ms) [Parameters=[@p0='2025-11-19T18:52:20.9881316Z' (DbType = DateTime), @p1='{"version":"1.0","items":[{"id":"fcf11f4b-3995-4d7b-a7b7-7fde18c0d018","type":"image","filePath":"/uploads/media/2025/11/99ec900b-9bc6-4b09-94fa-11b733493e95.jpg","displayName":"stopa_3.jpg","fileSize":20482,"mimeType":"image/jpeg","uploadedAt":"2025-11-19T18:51:58.3339865Z","altText":null,"thumbnailPath":"/uploads/media/2025/11/99ec900b-9bc6-4b09-94fa-11b733493e95_thumb.jpg","order":0}]}' (DbType = Object), @p2=NULL (DbType = Object), @p3='0', @p4='<p>tesatsdf</p>' (Nullable = false), @p5='0', @p6='19', @p7='2025-11-19T18:52:20.9881317Z' (DbType = DateTime)], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:21.003 | INSERT INTO questions (created_at, media_content, options_json, order_index, question_text, question_type, survey_id, updated_at)
2025-11-19 21:52:21.003 | VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7)
2025-11-19 21:52:21.003 | RETURNING id, is_required; {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "18eaf8f1-8ff3-4032-bbbf-764efab79004", "ActionName": "SurveyBot.API.Controllers.QuestionsController.CreateQuestion (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000008", "RequestPath": "/api/surveys/19/questions", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.013 | [18:52:21 INF] Question 26 added to survey 19 successfully {"SourceContext": "SurveyBot.Infrastructure.Services.QuestionService", "ActionId": "18eaf8f1-8ff3-4032-bbbf-764efab79004", "ActionName": "SurveyBot.API.Controllers.QuestionsController.CreateQuestion (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:00000008", "RequestPath": "/api/surveys/19/questions", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.051 | [18:52:21 INF] HTTP POST /api/surveys/19/questions responded 201 in 296ms. TraceId: 0HNH7JHUUK3MT:00000008 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000008", "RequestPath": "/api/surveys/19/questions", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.052 | [18:52:21 INF] HTTP POST /api/surveys/19/questions responded 201 in 297.6852 ms {"RequestHost": "localhost:5000", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000008", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.058 | [18:52:21 INF] HTTP OPTIONS /api/surveys/19/activate started. TraceId: 0HNH7JHUUK3MT:00000009 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000009", "RequestPath": "/api/surveys/19/activate", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.059 | [18:52:21 INF] HTTP OPTIONS /api/surveys/19/activate responded 204 in 1ms. TraceId: 0HNH7JHUUK3MT:00000009 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000009", "RequestPath": "/api/surveys/19/activate", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.060 | [18:52:21 INF] HTTP OPTIONS /api/surveys/19/activate responded 204 in 1.8986 ms {"RequestHost": "localhost:5000", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:00000009", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.062 | [18:52:21 INF] HTTP POST /api/surveys/19/activate started. TraceId: 0HNH7JHUUK3MT:0000000A {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:0000000A", "RequestPath": "/api/surveys/19/activate", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.064 | [18:52:21 DBG] JWT token validated for user ID: 4 {"RequestId": "0HNH7JHUUK3MT:0000000A", "RequestPath": "/api/surveys/19/activate", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.073 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:52:21.073 | [18:52:21 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"ActionId": "ff38ae3e-e8e4-4abb-9eb1-1b116bdce736", "ActionName": "SurveyBot.API.Controllers.SurveysController.ActivateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:0000000A", "RequestPath": "/api/surveys/19/activate", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.078 | [18:52:21 INF] Activating survey 19 for user 4 {"SourceContext": "SurveyBot.API.Controllers.SurveysController", "ActionId": "ff38ae3e-e8e4-4abb-9eb1-1b116bdce736", "ActionName": "SurveyBot.API.Controllers.SurveysController.ActivateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:0000000A", "RequestPath": "/api/surveys/19/activate", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.079 | [18:52:21 INF] Activating survey 19 by user 4 {"SourceContext": "SurveyBot.Infrastructure.Services.SurveyService", "ActionId": "ff38ae3e-e8e4-4abb-9eb1-1b116bdce736", "ActionName": "SurveyBot.API.Controllers.SurveysController.ActivateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:0000000A", "RequestPath": "/api/surveys/19/activate", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.083 | [18:52:21 INF] Executed DbCommand (2ms) [Parameters=[@__id_0='19'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:21.083 | SELECT s0.id, s0.allow_multiple_responses, s0.code, s0.created_at, s0.creator_id, s0.description, s0.is_active, s0.show_results, s0.title, s0.updated_at, s0.id0, q.id, q.created_at, q.is_required, q.media_content, q.options_json, q.order_index, q.question_text, q.question_type, q.survey_id, q.updated_at, s0.created_at0, s0.first_name, s0.last_login_at, s0.last_name, s0.telegram_id, s0.updated_at0, s0.username
2025-11-19 21:52:21.083 | FROM (
2025-11-19 21:52:21.083 |     SELECT s.id, s.allow_multiple_responses, s.code, s.created_at, s.creator_id, s.description, s.is_active, s.show_results, s.title, s.updated_at, u.id AS id0, u.created_at AS created_at0, u.first_name, u.last_login_at, u.last_name, u.telegram_id, u.updated_at AS updated_at0, u.username
2025-11-19 21:52:21.083 |     FROM surveys AS s
2025-11-19 21:52:21.083 |     INNER JOIN users AS u ON s.creator_id = u.id
2025-11-19 21:52:21.083 |     WHERE s.id = @__id_0
2025-11-19 21:52:21.083 |     LIMIT 1
2025-11-19 21:52:21.083 | ) AS s0
2025-11-19 21:52:21.083 | LEFT JOIN questions AS q ON s0.id = q.survey_id
2025-11-19 21:52:21.083 | ORDER BY s0.id, s0.id0, q.order_index {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "ff38ae3e-e8e4-4abb-9eb1-1b116bdce736", "ActionName": "SurveyBot.API.Controllers.SurveysController.ActivateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:0000000A", "RequestPath": "/api/surveys/19/activate", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.148 | [18:52:21 INF] Executed DbCommand (5ms) [Parameters=[@p9='26', @p0='2025-11-19T18:52:20.9881310Z' (DbType = DateTime), @p1='True', @p2='{"items": [{"id": "fcf11f4b-3995-4d7b-a7b7-7fde18c0d018", "type": "image", "order": 0, "altText": null, "filePath": "/uploads/media/2025/11/99ec900b-9bc6-4b09-94fa-11b733493e95.jpg", "fileSize": 20482, "mimeType": "image/jpeg", "uploadedAt": "2025-11-19T18:51:58.3339865Z", "displayName": "stopa_3.jpg", "thumbnailPath": "/uploads/media/2025/11/99ec900b-9bc6-4b09-94fa-11b733493e95_thumb.jpg"}], "version": "1.0"}' (DbType = Object), @p3=NULL (DbType = Object), @p4='0', @p5='<p>tesatsdf</p>' (Nullable = false), @p6='0', @p7='19', @p8='2025-11-19T18:52:21.1089068Z' (DbType = DateTime), @p19='19', @p10='False', @p11='ORN90O', @p12='2025-11-19T18:52:20.5635120Z' (DbType = DateTime), @p13='4', @p14='twsting', @p15='True', @p16='True', @p17='testing9' (Nullable = false), @p18='2025-11-19T18:52:21.1089060Z' (DbType = DateTime), @p27='4', @p20='2025-11-15T09:10:10.0111920Z' (DbType = DateTime), @p21=NULL, @p22=NULL (DbType = DateTime), @p23=NULL, @p24='123456789', @p25='2025-11-19T18:52:21.1089064Z' (DbType = DateTime), @p26=NULL], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:21.148 | UPDATE questions SET created_at = @p0, is_required = @p1, media_content = @p2, options_json = @p3, order_index = @p4, question_text = @p5, question_type = @p6, survey_id = @p7, updated_at = @p8
2025-11-19 21:52:21.148 | WHERE id = @p9;
2025-11-19 21:52:21.148 | UPDATE surveys SET allow_multiple_responses = @p10, code = @p11, created_at = @p12, creator_id = @p13, description = @p14, is_active = @p15, show_results = @p16, title = @p17, updated_at = @p18
2025-11-19 21:52:21.148 | WHERE id = @p19;
2025-11-19 21:52:21.148 | UPDATE users SET created_at = @p20, first_name = @p21, last_login_at = @p22, last_name = @p23, telegram_id = @p24, updated_at = @p25, username = @p26
2025-11-19 21:52:21.148 | WHERE id = @p27; {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "ff38ae3e-e8e4-4abb-9eb1-1b116bdce736", "ActionName": "SurveyBot.API.Controllers.SurveysController.ActivateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:0000000A", "RequestPath": "/api/surveys/19/activate", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.192 | [18:52:21 INF] Survey 19 activated successfully {"SourceContext": "SurveyBot.Infrastructure.Services.SurveyService", "ActionId": "ff38ae3e-e8e4-4abb-9eb1-1b116bdce736", "ActionName": "SurveyBot.API.Controllers.SurveysController.ActivateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:0000000A", "RequestPath": "/api/surveys/19/activate", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.195 | [18:52:21 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='19'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:21.195 | SELECT count(*)::int
2025-11-19 21:52:21.195 | FROM responses AS r
2025-11-19 21:52:21.195 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "ff38ae3e-e8e4-4abb-9eb1-1b116bdce736", "ActionName": "SurveyBot.API.Controllers.SurveysController.ActivateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:0000000A", "RequestPath": "/api/surveys/19/activate", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.198 | [18:52:21 INF] Executed DbCommand (2ms) [Parameters=[@__surveyId_0='19'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:21.198 | SELECT count(*)::int
2025-11-19 21:52:21.198 | FROM responses AS r
2025-11-19 21:52:21.198 | WHERE r.survey_id = @__surveyId_0 AND r.is_complete {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "ff38ae3e-e8e4-4abb-9eb1-1b116bdce736", "ActionName": "SurveyBot.API.Controllers.SurveysController.ActivateSurvey (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:0000000A", "RequestPath": "/api/surveys/19/activate", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.212 | [18:52:21 INF] HTTP POST /api/surveys/19/activate responded 200 in 148ms. TraceId: 0HNH7JHUUK3MT:0000000A {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:0000000A", "RequestPath": "/api/surveys/19/activate", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.213 | [18:52:21 INF] HTTP POST /api/surveys/19/activate responded 200 in 149.9408 ms {"RequestHost": "localhost:5000", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:0000000A", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.219 | [18:52:21 INF] HTTP OPTIONS /api/surveys/19 started. TraceId: 0HNH7JHUUK3MT:0000000B {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:0000000B", "RequestPath": "/api/surveys/19", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.219 | [18:52:21 INF] HTTP OPTIONS /api/surveys/19 responded 204 in 0ms. TraceId: 0HNH7JHUUK3MT:0000000B {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:0000000B", "RequestPath": "/api/surveys/19", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.220 | [18:52:21 INF] HTTP OPTIONS /api/surveys/19 responded 204 in 1.8956 ms {"RequestHost": "localhost:5000", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:0000000B", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.224 | [18:52:21 INF] HTTP GET /api/surveys/19 started. TraceId: 0HNH7JHUUK3MT:0000000C {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:0000000C", "RequestPath": "/api/surveys/19", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.226 | [18:52:21 DBG] JWT token validated for user ID: 4 {"RequestId": "0HNH7JHUUK3MT:0000000C", "RequestPath": "/api/surveys/19", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.231 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:52:21.232 | [18:52:21 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"ActionId": "2ee24f71-b413-4c9a-8d94-5133cd867b52", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveyById (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:0000000C", "RequestPath": "/api/surveys/19", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.235 | [18:52:21 INF] Getting survey 19 for user 4 {"SourceContext": "SurveyBot.API.Controllers.SurveysController", "ActionId": "2ee24f71-b413-4c9a-8d94-5133cd867b52", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveyById (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:0000000C", "RequestPath": "/api/surveys/19", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.237 | [18:52:21 INF] Getting survey 19 for user 4 {"SourceContext": "SurveyBot.Infrastructure.Services.SurveyService", "ActionId": "2ee24f71-b413-4c9a-8d94-5133cd867b52", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveyById (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:0000000C", "RequestPath": "/api/surveys/19", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.242 | [18:52:21 INF] Executed DbCommand (3ms) [Parameters=[@__id_0='19'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:21.242 | SELECT s0.id, s0.allow_multiple_responses, s0.code, s0.created_at, s0.creator_id, s0.description, s0.is_active, s0.show_results, s0.title, s0.updated_at, s0.id0, q.id, q.created_at, q.is_required, q.media_content, q.options_json, q.order_index, q.question_text, q.question_type, q.survey_id, q.updated_at, s0.created_at0, s0.first_name, s0.last_login_at, s0.last_name, s0.telegram_id, s0.updated_at0, s0.username
2025-11-19 21:52:21.242 | FROM (
2025-11-19 21:52:21.242 |     SELECT s.id, s.allow_multiple_responses, s.code, s.created_at, s.creator_id, s.description, s.is_active, s.show_results, s.title, s.updated_at, u.id AS id0, u.created_at AS created_at0, u.first_name, u.last_login_at, u.last_name, u.telegram_id, u.updated_at AS updated_at0, u.username
2025-11-19 21:52:21.242 |     FROM surveys AS s
2025-11-19 21:52:21.242 |     INNER JOIN users AS u ON s.creator_id = u.id
2025-11-19 21:52:21.242 |     WHERE s.id = @__id_0
2025-11-19 21:52:21.242 |     LIMIT 1
2025-11-19 21:52:21.242 | ) AS s0
2025-11-19 21:52:21.242 | LEFT JOIN questions AS q ON s0.id = q.survey_id
2025-11-19 21:52:21.242 | ORDER BY s0.id, s0.id0, q.order_index {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "2ee24f71-b413-4c9a-8d94-5133cd867b52", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveyById (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:0000000C", "RequestPath": "/api/surveys/19", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.245 | [18:52:21 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='19'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:21.245 | SELECT count(*)::int
2025-11-19 21:52:21.245 | FROM responses AS r
2025-11-19 21:52:21.245 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "2ee24f71-b413-4c9a-8d94-5133cd867b52", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveyById (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:0000000C", "RequestPath": "/api/surveys/19", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.247 | [18:52:21 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='19'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:21.247 | SELECT count(*)::int
2025-11-19 21:52:21.247 | FROM responses AS r
2025-11-19 21:52:21.247 | WHERE r.survey_id = @__surveyId_0 AND r.is_complete {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "ActionId": "2ee24f71-b413-4c9a-8d94-5133cd867b52", "ActionName": "SurveyBot.API.Controllers.SurveysController.GetSurveyById (SurveyBot.API)", "RequestId": "0HNH7JHUUK3MT:0000000C", "RequestPath": "/api/surveys/19", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.250 | [18:52:21 INF] HTTP GET /api/surveys/19 responded 200 in 25ms. TraceId: 0HNH7JHUUK3MT:0000000C {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:0000000C", "RequestPath": "/api/surveys/19", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:21.251 | [18:52:21 INF] HTTP GET /api/surveys/19 responded 200 in 26.1448 ms {"RequestHost": "localhost:5000", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3MT:0000000C", "ConnectionId": "0HNH7JHUUK3MT", "Application": "SurveyBot.API"}
2025-11-19 21:52:22.252 | [18:52:22 INF] HTTP GET /health/db started. TraceId: 0HNH7JHUUK3N1:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N1:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3N1", "Application": "SurveyBot.API"}
2025-11-19 21:52:22.253 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:52:22.253 | [18:52:22 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"RequestId": "0HNH7JHUUK3N1:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3N1", "Application": "SurveyBot.API"}
2025-11-19 21:52:22.266 | [18:52:22 INF] HTTP GET /health/db responded 200 in 13ms. TraceId: 0HNH7JHUUK3N1:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N1:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3N1", "Application": "SurveyBot.API"}
2025-11-19 21:52:22.267 | [18:52:22 INF] HTTP GET /health/db responded 200 in 14.1799 ms {"RequestHost": "localhost:8080", "RequestScheme": "http", "RemoteIP": "::ffff:127.0.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N1:00000001", "ConnectionId": "0HNH7JHUUK3N1", "Application": "SurveyBot.API"}
2025-11-19 21:52:28.845 | [18:52:28 INF] HTTP POST /api/bot/webhook started. TraceId: 0HNH7JHUUK3N2:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N2:00000001", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:28.850 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:52:28.850 | [18:52:28 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000001", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:28.853 | [18:52:28 INF] Cleanup timer started: interval=5 minutes, expiration=30 minutes {"SourceContext": "SurveyBot.Bot.Services.ConversationStateManager", "ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000001", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:28.854 | [18:52:28 INF] ConversationStateManager initialized {"SourceContext": "SurveyBot.Bot.Services.ConversationStateManager", "ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000001", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:28.862 | [18:52:28 INF] AdminAuthService initialized with 1 admin users {"SourceContext": "SurveyBot.Bot.Services.AdminAuthService", "ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000001", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:28.866 | [18:52:28 INF] CommandRouter initialized with 13 command handlers: start, help, mysurveys, surveys, survey, cancel, preview, createsurvey, listsurveys, activate, deactivate, stats, adminhelp {"SourceContext": "SurveyBot.Bot.Services.CommandRouter", "ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000001", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:28.868 | [18:52:28 INF] SurveyCache initialized with TTL=5 minutes {"SourceContext": "SurveyBot.Bot.Services.SurveyCache", "ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000001", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.176 | [18:52:29 INF] Webhook received update 943474227 of type Message {"SourceContext": "SurveyBot.API.Controllers.BotController", "ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000001", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.177 | [18:52:29 DBG] Background work item queued successfully {"SourceContext": "SurveyBot.API.Services.BackgroundTaskQueue", "ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000001", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.179 | [18:52:29 DBG] Background work item dequeued {"SourceContext": "SurveyBot.API.Services.BackgroundTaskQueue", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.181 | [18:52:29 DBG] Executing background work item with new service scope {"SourceContext": "SurveyBot.API.Services.QueuedHostedService", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.184 | [18:52:29 DBG] Processing update 943474227 in background {"SourceContext": "SurveyBot.API.Controllers.BotController", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.185 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:52:29.185 | [18:52:29 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"Application": "SurveyBot.API"}
2025-11-19 21:52:29.185 | [18:52:29 INF] HTTP POST /api/bot/webhook responded 200 in 340ms. TraceId: 0HNH7JHUUK3N2:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N2:00000001", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.186 | [18:52:29 INF] HTTP POST /api/bot/webhook responded 200 in 341.2465 ms {"RequestHost": "3c6dfc99c860.ngrok-free.app", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N2:00000001", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.199 | [18:52:29 INF] CommandRouter initialized with 13 command handlers: start, help, mysurveys, surveys, survey, cancel, preview, createsurvey, listsurveys, activate, deactivate, stats, adminhelp {"SourceContext": "SurveyBot.Bot.Services.CommandRouter", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.211 | [18:52:29 INF] Received update 943474227 of type Message {"SourceContext": "SurveyBot.Bot.Services.UpdateHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.212 | [18:52:29 INF] Processing message from user 7743614483 in chat 7743614483: /start {"SourceContext": "SurveyBot.Bot.Services.UpdateHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.215 | [18:52:29 INF] Routing command 'start' from user 7743614483 in chat 7743614483 {"SourceContext": "SurveyBot.Bot.Services.CommandRouter", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.215 | [18:52:29 DBG] Found handler for command 'start' {"SourceContext": "SurveyBot.Bot.Services.CommandRouter", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.218 | [18:52:29 INF] Processing /start command from user 7743614483 (@SeptiusK) {"SourceContext": "SurveyBot.Bot.Handlers.Commands.StartCommandHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.220 | [DEBUG CreateOrUpdateAsync] Starting for telegramId: 7743614483
2025-11-19 21:52:29.222 | [DEBUG UserRepository] Connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=surveybot_dev_password;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:52:29.223 | [DEBUG UserRepository] Database provider: Npgsql.EntityFrameworkCore.PostgreSQL
2025-11-19 21:52:29.240 | [DEBUG UserRepository] Can connect: True
2025-11-19 21:52:29.257 | [18:52:29 INF] Executed DbCommand (1ms) [Parameters=[@__telegramId_0='7743614483'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:29.257 | SELECT u.id, u.created_at, u.first_name, u.last_login_at, u.last_name, u.telegram_id, u.updated_at, u.username
2025-11-19 21:52:29.257 | FROM users AS u
2025-11-19 21:52:29.257 | WHERE u.telegram_id = @__telegramId_0
2025-11-19 21:52:29.257 | LIMIT 1 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.262 | [18:52:29 INF] User 1 registered/updated successfully. TelegramId: 7743614483 {"SourceContext": "SurveyBot.Bot.Handlers.Commands.StartCommandHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.803 | [18:52:29 INF] Welcome message sent to user 7743614483 in chat 7743614483 {"SourceContext": "SurveyBot.Bot.Handlers.Commands.StartCommandHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.804 | [18:52:29 INF] Command 'start' handled successfully for user 7743614483 {"SourceContext": "SurveyBot.Bot.Services.CommandRouter", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.805 | [18:52:29 INF] Update 943474227 handled successfully {"SourceContext": "SurveyBot.Bot.Services.UpdateHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.807 | [18:52:29 DBG] Operation HandleUpdate [UpdateId=943474227, Type=Message] completed in 597ms {"SourceContext": "SurveyBot.Bot.Services.BotPerformanceMonitor", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.809 | [18:52:29 DBG] Update 943474227 processed successfully {"SourceContext": "SurveyBot.API.Controllers.BotController", "Application": "SurveyBot.API"}
2025-11-19 21:52:29.809 | [18:52:29 DBG] Background work item completed successfully {"SourceContext": "SurveyBot.API.Services.QueuedHostedService", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.874 | [18:52:30 INF] HTTP POST /api/bot/webhook started. TraceId: 0HNH7JHUUK3N2:00000002 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N2:00000002", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.885 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:52:30.886 | [18:52:30 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000002", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.916 | [18:52:30 INF] CommandRouter initialized with 13 command handlers: start, help, mysurveys, surveys, survey, cancel, preview, createsurvey, listsurveys, activate, deactivate, stats, adminhelp {"SourceContext": "SurveyBot.Bot.Services.CommandRouter", "ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000002", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.939 | [18:52:30 INF] Webhook received update 943474228 of type CallbackQuery {"SourceContext": "SurveyBot.API.Controllers.BotController", "ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000002", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.940 | [18:52:30 DBG] Background work item queued successfully {"SourceContext": "SurveyBot.API.Services.BackgroundTaskQueue", "ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000002", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.940 | [18:52:30 DBG] Background work item dequeued {"SourceContext": "SurveyBot.API.Services.BackgroundTaskQueue", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.941 | [18:52:30 DBG] Executing background work item with new service scope {"SourceContext": "SurveyBot.API.Services.QueuedHostedService", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.941 | [18:52:30 INF] HTTP POST /api/bot/webhook responded 200 in 67ms. TraceId: 0HNH7JHUUK3N2:00000002 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N2:00000002", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.942 | [18:52:30 DBG] Processing update 943474228 in background {"SourceContext": "SurveyBot.API.Controllers.BotController", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.943 | [18:52:30 INF] HTTP POST /api/bot/webhook responded 200 in 68.8764 ms {"RequestHost": "3c6dfc99c860.ngrok-free.app", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N2:00000002", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.944 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:52:30.944 | [18:52:30 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"Application": "SurveyBot.API"}
2025-11-19 21:52:30.948 | [18:52:30 INF] CommandRouter initialized with 13 command handlers: start, help, mysurveys, surveys, survey, cancel, preview, createsurvey, listsurveys, activate, deactivate, stats, adminhelp {"SourceContext": "SurveyBot.Bot.Services.CommandRouter", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.949 | [18:52:30 INF] Received update 943474228 of type CallbackQuery {"SourceContext": "SurveyBot.Bot.Services.UpdateHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.959 | [18:52:30 INF] Processing callback query from user 7743614483: cmd:surveys {"SourceContext": "SurveyBot.Bot.Services.UpdateHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.962 | [18:52:30 INF] Processing callback command 'surveys' from user 7743614483 {"SourceContext": "SurveyBot.Bot.Services.UpdateHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:30.968 | [18:52:30 INF] Processing /surveys command from user 8540672675 {"SourceContext": "SurveyBot.Bot.Handlers.Commands.SurveysCommandHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:31.028 | [18:52:31 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:31.028 | SELECT s.id, s.allow_multiple_responses, s.code, s.created_at, s.creator_id, s.description, s.is_active, s.show_results, s.title, s.updated_at, u.id, q.id, q.created_at, q.is_required, q.media_content, q.options_json, q.order_index, q.question_text, q.question_type, q.survey_id, q.updated_at, u.created_at, u.first_name, u.last_login_at, u.last_name, u.telegram_id, u.updated_at, u.username
2025-11-19 21:52:31.028 | FROM surveys AS s
2025-11-19 21:52:31.028 | INNER JOIN users AS u ON s.creator_id = u.id
2025-11-19 21:52:31.028 | LEFT JOIN questions AS q ON s.id = q.survey_id
2025-11-19 21:52:31.028 | WHERE s.is_active
2025-11-19 21:52:31.028 | ORDER BY s.created_at DESC, s.id, u.id {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "Application": "SurveyBot.API"}
2025-11-19 21:52:31.034 | [18:52:31 INF] Found 3 active surveys {"SourceContext": "SurveyBot.Bot.Handlers.Commands.SurveysCommandHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:31.039 | [18:52:31 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='19'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:31.039 | SELECT count(*)::int
2025-11-19 21:52:31.039 | FROM responses AS r
2025-11-19 21:52:31.039 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "Application": "SurveyBot.API"}
2025-11-19 21:52:31.042 | [18:52:31 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='18'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:31.042 | SELECT count(*)::int
2025-11-19 21:52:31.042 | FROM responses AS r
2025-11-19 21:52:31.042 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "Application": "SurveyBot.API"}
2025-11-19 21:52:31.043 | [18:52:31 INF] Executed DbCommand (1ms) [Parameters=[@__surveyId_0='3'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:31.043 | SELECT count(*)::int
2025-11-19 21:52:31.043 | FROM responses AS r
2025-11-19 21:52:31.043 | WHERE r.survey_id = @__surveyId_0 {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "Application": "SurveyBot.API"}
2025-11-19 21:52:31.176 | [18:52:31 INF] Survey list sent to user 8540672675 in chat 7743614483 {"SourceContext": "SurveyBot.Bot.Handlers.Commands.SurveysCommandHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:31.298 | [18:52:31 DBG] Operation HandleCallbackQuery [UserId=7743614483, Data=cmd:surveys] completed in 343ms {"SourceContext": "SurveyBot.Bot.Services.BotPerformanceMonitor", "Application": "SurveyBot.API"}
2025-11-19 21:52:31.299 | [18:52:31 INF] Update 943474228 handled successfully {"SourceContext": "SurveyBot.Bot.Services.UpdateHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:31.300 | [18:52:31 DBG] Operation HandleUpdate [UpdateId=943474228, Type=CallbackQuery] completed in 350ms {"SourceContext": "SurveyBot.Bot.Services.BotPerformanceMonitor", "Application": "SurveyBot.API"}
2025-11-19 21:52:31.301 | [18:52:31 DBG] Update 943474228 processed successfully {"SourceContext": "SurveyBot.API.Controllers.BotController", "Application": "SurveyBot.API"}
2025-11-19 21:52:31.301 | [18:52:31 DBG] Background work item completed successfully {"SourceContext": "SurveyBot.API.Services.QueuedHostedService", "Application": "SurveyBot.API"}
2025-11-19 21:52:33.836 | [18:52:33 INF] HTTP POST /api/bot/webhook started. TraceId: 0HNH7JHUUK3N2:00000003 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N2:00000003", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:33.837 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:52:33.837 | [18:52:33 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000003", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:33.840 | [18:52:33 INF] CommandRouter initialized with 13 command handlers: start, help, mysurveys, surveys, survey, cancel, preview, createsurvey, listsurveys, activate, deactivate, stats, adminhelp {"SourceContext": "SurveyBot.Bot.Services.CommandRouter", "ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000003", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:33.843 | [18:52:33 INF] Webhook received update 943474229 of type CallbackQuery {"SourceContext": "SurveyBot.API.Controllers.BotController", "ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000003", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:33.844 | [18:52:33 DBG] Background work item queued successfully {"SourceContext": "SurveyBot.API.Services.BackgroundTaskQueue", "ActionId": "d667f2ec-73ee-4f9c-91e9-97ccf9d65fa8", "ActionName": "SurveyBot.API.Controllers.BotController.Webhook (SurveyBot.API)", "RequestId": "0HNH7JHUUK3N2:00000003", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:33.845 | [18:52:33 DBG] Background work item dequeued {"SourceContext": "SurveyBot.API.Services.BackgroundTaskQueue", "Application": "SurveyBot.API"}
2025-11-19 21:52:33.846 | [18:52:33 INF] HTTP POST /api/bot/webhook responded 200 in 9ms. TraceId: 0HNH7JHUUK3N2:00000003 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N2:00000003", "RequestPath": "/api/bot/webhook", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:33.847 | [18:52:33 DBG] Executing background work item with new service scope {"SourceContext": "SurveyBot.API.Services.QueuedHostedService", "Application": "SurveyBot.API"}
2025-11-19 21:52:33.848 | [18:52:33 INF] HTTP POST /api/bot/webhook responded 200 in 11.7009 ms {"RequestHost": "3c6dfc99c860.ngrok-free.app", "RequestScheme": "http", "RemoteIP": "::ffff:172.20.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N2:00000003", "ConnectionId": "0HNH7JHUUK3N2", "Application": "SurveyBot.API"}
2025-11-19 21:52:33.848 | [18:52:33 DBG] Processing update 943474229 in background {"SourceContext": "SurveyBot.API.Controllers.BotController", "Application": "SurveyBot.API"}
2025-11-19 21:52:33.850 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:52:33.850 | [18:52:33 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"Application": "SurveyBot.API"}
2025-11-19 21:52:33.854 | [18:52:33 INF] CommandRouter initialized with 13 command handlers: start, help, mysurveys, surveys, survey, cancel, preview, createsurvey, listsurveys, activate, deactivate, stats, adminhelp {"SourceContext": "SurveyBot.Bot.Services.CommandRouter", "Application": "SurveyBot.API"}
2025-11-19 21:52:33.855 | [18:52:33 INF] Received update 943474229 of type CallbackQuery {"SourceContext": "SurveyBot.Bot.Services.UpdateHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:33.856 | [18:52:33 INF] Processing callback query from user 7743614483: survey:take:ORN90O {"SourceContext": "SurveyBot.Bot.Services.UpdateHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:33.866 | [18:52:33 INF] Starting survey ORN90O for user 7743614483 via callback {"SourceContext": "SurveyBot.Bot.Services.UpdateHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:34.172 | [18:52:34 INF] Processing /survey command from user 7743614483 (@SeptiusK) {"SourceContext": "SurveyBot.Bot.Handlers.Commands.SurveyCommandHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:34.219 | [18:52:34 INF] Executed DbCommand (4ms) [Parameters=[@__ToUpper_0='ORN90O'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:34.219 | SELECT s0.id, s0.allow_multiple_responses, s0.code, s0.created_at, s0.creator_id, s0.description, s0.is_active, s0.show_results, s0.title, s0.updated_at, s0.id0, q.id, q.created_at, q.is_required, q.media_content, q.options_json, q.order_index, q.question_text, q.question_type, q.survey_id, q.updated_at, s0.created_at0, s0.first_name, s0.last_login_at, s0.last_name, s0.telegram_id, s0.updated_at0, s0.username
2025-11-19 21:52:34.219 | FROM (
2025-11-19 21:52:34.219 |     SELECT s.id, s.allow_multiple_responses, s.code, s.created_at, s.creator_id, s.description, s.is_active, s.show_results, s.title, s.updated_at, u.id AS id0, u.created_at AS created_at0, u.first_name, u.last_login_at, u.last_name, u.telegram_id, u.updated_at AS updated_at0, u.username
2025-11-19 21:52:34.219 |     FROM surveys AS s
2025-11-19 21:52:34.219 |     INNER JOIN users AS u ON s.creator_id = u.id
2025-11-19 21:52:34.219 |     WHERE s.code = @__ToUpper_0
2025-11-19 21:52:34.219 |     LIMIT 1
2025-11-19 21:52:34.219 | ) AS s0
2025-11-19 21:52:34.219 | LEFT JOIN questions AS q ON s0.id = q.survey_id
2025-11-19 21:52:34.219 | ORDER BY s0.id, s0.id0, q.order_index {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "Application": "SurveyBot.API"}
2025-11-19 21:52:34.264 | [18:52:34 WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'. {"EventId": {"Id": 20504, "Name": "Microsoft.EntityFrameworkCore.Query.MultipleCollectionIncludeWarning"}, "SourceContext": "Microsoft.EntityFrameworkCore.Query", "Application": "SurveyBot.API"}
2025-11-19 21:52:34.329 | [18:52:34 INF] Executed DbCommand (9ms) [Parameters=[@__surveyId_0='19', @__telegramId_1='7743614483'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:34.329 | SELECT s0.id, s0.is_complete, s0.respondent_telegram_id, s0.started_at, s0.submitted_at, s0.survey_id, s0.id0, s1.id, s1.answer_json, s1.answer_text, s1.created_at, s1.question_id, s1.response_id, s1.id0, s1.created_at0, s1.is_required, s1.media_content, s1.options_json, s1.order_index, s1.question_text, s1.question_type, s1.survey_id, s1.updated_at, s0.allow_multiple_responses, s0.code, s0.created_at, s0.creator_id, s0.description, s0.is_active, s0.show_results, s0.title, s0.updated_at, q0.id, q0.created_at, q0.is_required, q0.media_content, q0.options_json, q0.order_index, q0.question_text, q0.question_type, q0.survey_id, q0.updated_at
2025-11-19 21:52:34.329 | FROM (
2025-11-19 21:52:34.329 |     SELECT r.id, r.is_complete, r.respondent_telegram_id, r.started_at, r.submitted_at, r.survey_id, s.id AS id0, s.allow_multiple_responses, s.code, s.created_at, s.creator_id, s.description, s.is_active, s.show_results, s.title, s.updated_at
2025-11-19 21:52:34.329 |     FROM responses AS r
2025-11-19 21:52:34.329 |     INNER JOIN surveys AS s ON r.survey_id = s.id
2025-11-19 21:52:34.329 |     WHERE r.survey_id = @__surveyId_0 AND r.respondent_telegram_id = @__telegramId_1 AND NOT (r.is_complete)
2025-11-19 21:52:34.329 |     LIMIT 1
2025-11-19 21:52:34.329 | ) AS s0
2025-11-19 21:52:34.329 | LEFT JOIN (
2025-11-19 21:52:34.329 |     SELECT a.id, a.answer_json, a.answer_text, a.created_at, a.question_id, a.response_id, q.id AS id0, q.created_at AS created_at0, q.is_required, q.media_content, q.options_json, q.order_index, q.question_text, q.question_type, q.survey_id, q.updated_at
2025-11-19 21:52:34.329 |     FROM answers AS a
2025-11-19 21:52:34.329 |     INNER JOIN questions AS q ON a.question_id = q.id
2025-11-19 21:52:34.329 | ) AS s1 ON s0.id = s1.response_id
2025-11-19 21:52:34.329 | LEFT JOIN questions AS q0 ON s0.id0 = q0.survey_id
2025-11-19 21:52:34.329 | ORDER BY s0.id, s0.id0, s1.id, s1.id0, q0.order_index {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "Application": "SurveyBot.API"}
2025-11-19 21:52:34.375 | [18:52:34 INF] Executed DbCommand (3ms) [Parameters=[@__surveyId_0='19', @__telegramId_1='7743614483'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:34.375 | SELECT r.id, r.is_complete, r.respondent_telegram_id, r.started_at, r.submitted_at, r.survey_id, a.id, a.answer_json, a.answer_text, a.created_at, a.question_id, a.response_id
2025-11-19 21:52:34.375 | FROM responses AS r
2025-11-19 21:52:34.375 | LEFT JOIN answers AS a ON r.id = a.response_id
2025-11-19 21:52:34.375 | WHERE r.survey_id = @__surveyId_0 AND r.respondent_telegram_id = @__telegramId_1
2025-11-19 21:52:34.375 | ORDER BY COALESCE(r.submitted_at, r.started_at) DESC, r.id {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "Application": "SurveyBot.API"}
2025-11-19 21:52:34.395 | [18:52:34 INF] Executed DbCommand (10ms) [Parameters=[@p0='7743614483', @p1='2025-11-19T18:52:34.3765567Z' (Nullable = true) (DbType = DateTime), @p2=NULL (DbType = DateTime), @p3='19'], CommandType='Text', CommandTimeout='30']
2025-11-19 21:52:34.395 | INSERT INTO responses (respondent_telegram_id, started_at, submitted_at, survey_id)
2025-11-19 21:52:34.395 | VALUES (@p0, @p1, @p2, @p3)
2025-11-19 21:52:34.395 | RETURNING id, is_complete; {"EventId": {"Id": 20101, "Name": "Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"}, "SourceContext": "Microsoft.EntityFrameworkCore.Database.Command", "Application": "SurveyBot.API"}
2025-11-19 21:52:34.399 | [18:52:34 INF] Created response 17 for user 7743614483 on survey 19 {"SourceContext": "SurveyBot.Bot.Handlers.Commands.SurveyCommandHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:34.405 | [18:52:34 DBG] State set for user 7743614483: InSurvey {"SourceContext": "SurveyBot.Bot.Services.ConversationStateManager", "Application": "SurveyBot.API"}
2025-11-19 21:52:34.405 | [18:52:34 INF] Survey started for user 7743614483: survey=19, response=17, questions=1 {"SourceContext": "SurveyBot.Bot.Services.ConversationStateManager", "Application": "SurveyBot.API"}
2025-11-19 21:52:35.560 | [18:52:35 DBG] Question 26 has no media content, skipping media send {"SourceContext": "SurveyBot.Bot.Handlers.Questions.QuestionMediaHelper", "Application": "SurveyBot.API"}
2025-11-19 21:52:35.561 | [18:52:35 DBG] Displaying text question 26 in chat 7743614483 {"SourceContext": "SurveyBot.Bot.Handlers.Questions.TextQuestionHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:35.719 | [18:52:35 INF] Survey 0 started for user 7743614483, displayed question 1/1 {"SourceContext": "SurveyBot.Bot.Handlers.Commands.SurveyCommandHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:35.843 | [18:52:35 WRN] SLOW OPERATION: HandleCallbackQuery [UserId=7743614483, Data=survey:take:ORN90O] completed in 1986ms (threshold: 1000ms) {"SourceContext": "SurveyBot.Bot.Services.BotPerformanceMonitor", "Application": "SurveyBot.API"}
2025-11-19 21:52:35.846 | [18:52:35 INF] Update 943474229 handled successfully {"SourceContext": "SurveyBot.Bot.Services.UpdateHandler", "Application": "SurveyBot.API"}
2025-11-19 21:52:35.848 | [18:52:35 WRN] SLOW OPERATION: HandleUpdate [UpdateId=943474229, Type=CallbackQuery] completed in 1992ms (threshold: 1000ms) {"SourceContext": "SurveyBot.Bot.Services.BotPerformanceMonitor", "Application": "SurveyBot.API"}
2025-11-19 21:52:35.849 | [18:52:35 DBG] Update 943474229 processed successfully {"SourceContext": "SurveyBot.API.Controllers.BotController", "Application": "SurveyBot.API"}
2025-11-19 21:52:35.849 | [18:52:35 DBG] Background work item completed successfully {"SourceContext": "SurveyBot.API.Services.QueuedHostedService", "Application": "SurveyBot.API"}
2025-11-19 21:52:52.397 | [18:52:52 INF] HTTP GET /health/db started. TraceId: 0HNH7JHUUK3N3:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N3:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3N3", "Application": "SurveyBot.API"}
2025-11-19 21:52:52.398 | [DEBUG] Using connection string: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100;
2025-11-19 21:52:52.399 | [18:52:52 INF] Database connection string configured: Host=postgres;Port=5432;Database=surveybot_db;Username=surveybot_user;Password=***;Timeout=30;CommandTimeout=30;Pooling=true;MinPoolSize=0;MaxPoolSize=100; {"RequestId": "0HNH7JHUUK3N3:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3N3", "Application": "SurveyBot.API"}
2025-11-19 21:52:52.418 | [18:52:52 INF] HTTP GET /health/db responded 200 in 20ms. TraceId: 0HNH7JHUUK3N3:00000001 {"SourceContext": "SurveyBot.API.Middleware.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N3:00000001", "RequestPath": "/health/db", "ConnectionId": "0HNH7JHUUK3N3", "Application": "SurveyBot.API"}
2025-11-19 21:52:52.419 | [18:52:52 INF] HTTP GET /health/db responded 200 in 21.4017 ms {"RequestHost": "localhost:8080", "RequestScheme": "http", "RemoteIP": "::ffff:127.0.0.1", "SourceContext": "Serilog.AspNetCore.RequestLoggingMiddleware", "RequestId": "0HNH7JHUUK3N3:00000001", "ConnectionId": "0HNH7JHUUK3N3", "Application": "SurveyBot.API"}